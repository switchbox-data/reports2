---
title: "Compute Embedded Costs"
---

Implements sections 2.3.3, 2.3.4, and 2.4 of
Measuring Cross-Subsidization for Seasonal Heat Pump Rates: Cost-of-Service Methodology Analysis
https://drive.google.com/drive/u/0/folders/16nlFAL_RwGl_INAJrhR5irgnNC-gj9zF

### IMPORTS
```{python}

    from buildstock_fetch.scenarios import uniform_adoption
    from buildstock_fetch.mixed_upgrade import MixedUpgradeScenario
    from buildstock_fetch.read import BuildStockRead

    import polars as pl
```

```{python}
    sbmeta = pl.scan_parquet("s3://data.sb/nrel/resstock/res_2024_amy2018_2/metadata/state=RI/upgrade=00/metadata-sb-with-heating-type.parquet")

    current_adoption_rate = sbmeta.collect().group_by("postprocess_group.heating_type").agg(pl.col("weight").sum().alias("total_homes")).pipe(lambda df: df.filter(pl.col("postprocess_group.heating_type") == "heat_pump")["total_homes"] / df["total_homes"].sum()).item()

    print(current_adoption_rate)
```
